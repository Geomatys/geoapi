# GeoAPI build tools
This module contains Javadoc taglets and annotation processing tools for processing GeoAPI after compilation.
Those tools are used mostly for javadoc generation.
They are internal to the GeoAPI project and may change at any time.


## Creating releases
The procedure for creating a GeoAPI release is documented in a [separated page](src/release-instruction.md).


## Documenting the API
The commands in the rest of this page assume that environment variables have been configured as below
(execute from the GeoAPI project home directory on a Unix machine).
Adjust the paths as necessary for the local installation.

```shell
export GEOAPI_VERSION=4.0-M20
export CLASSPATH=~/.m2/repository/javax/measure/unit-api/1.0/unit-api-1.0.jar
export CLASSPATH=$CLASSPATH:$PWD/geoapi/target/geoapi-$GEOAPI_VERSION.jar
export CLASSPATH=$CLASSPATH:$PWD/tools/target/tools-$GEOAPI_VERSION.jar
export GEOAPI_SITE=../site/archives
```


### Generating API index page
A summary of all types and members can be generated by the `IndexGenerator` processor.
Execute the following commands from the project root directory:

```shell
find geoapi/src/main/java -name "*.java" > content.txt
javac -proc:only -processor org.opengis.tools.apt.IndexGenerator \
                 -Aoutput=geoapi/src/main/javadoc/content.html \
                 -AnotesList=src/release-notes.properties @content.txt
rm content.txt
```


### Documenting a summary of API changes
A summary of API changes can be generated by the `ChangeReport` class.
Execute the following commands from the project root directory:

```shell
java org.opengis.tools.version.ChangeReport 3.0.1 3.1-SNAPSHOT $GEOAPI_SITE/snapshot/change-summary.html
cd ../site
git diff archives/snapshot/change-summary.html
```

To re-generate the API change summaries for previous releases
(for example after the `ChangeReport` class has been updated),
run the following commands:

```shell
java org.opengis.tools.version.ChangeReport 2.3-M5 2.3-M6 $GEOAPI_SITE/2.3-M6/since-M5.html
java org.opengis.tools.version.ChangeReport 2.3-M4 2.3-M6 $GEOAPI_SITE/2.3-M6/since-M4.html
java org.opengis.tools.version.ChangeReport 2.3-M3 2.3-M6 $GEOAPI_SITE/2.3-M6/since-M3.html
java org.opengis.tools.version.ChangeReport 2.3-M2 2.3-M6 $GEOAPI_SITE/2.3-M6/since-M2.html
java org.opengis.tools.version.ChangeReport 2.3-M1 2.3-M6 $GEOAPI_SITE/2.3-M6/since-M1.html
java org.opengis.tools.version.ChangeReport 2.3-M4 2.3-M5 $GEOAPI_SITE/2.3-M5/since-M4.html
java org.opengis.tools.version.ChangeReport 2.3-M3 2.3-M5 $GEOAPI_SITE/2.3-M5/since-M3.html
java org.opengis.tools.version.ChangeReport 2.3-M2 2.3-M5 $GEOAPI_SITE/2.3-M5/since-M2.html
java org.opengis.tools.version.ChangeReport 2.3-M1 2.3-M5 $GEOAPI_SITE/2.3-M5/since-M1.html
java org.opengis.tools.version.ChangeReport 2.3-M3 2.3-M4 $GEOAPI_SITE/2.3-M4/since-M3.html
java org.opengis.tools.version.ChangeReport 2.3-M2 2.3-M4 $GEOAPI_SITE/2.3-M4/since-M2.html
java org.opengis.tools.version.ChangeReport 2.3-M1 2.3-M4 $GEOAPI_SITE/2.3-M4/since-M1.html
java org.opengis.tools.version.ChangeReport 2.3-M2 2.3-M3 $GEOAPI_SITE/2.3-M3/since-M2.html
java org.opengis.tools.version.ChangeReport 2.3-M1 2.3-M3 $GEOAPI_SITE/2.3-M3/since-M1.html
java org.opengis.tools.version.ChangeReport 2.3-M1 2.3-M2 $GEOAPI_SITE/2.3-M2/since-M1.html
```
